---
layout:     post
title:      "如何十步免费构建研发运维一体化？"
subtitle:   "《推蜜》官方互动养成APP，借力《阿里云》从零到壹的演变"
date:       2017-02-18 10:00:00
author:     "李牧牧"
header-img: "http://onb688cva.bkt.clouddn.com/assets:img:home-bg.jpg"
header-mask: 0.1
catalog:    true
tags:
    - 阿里云
    - 混合云
---

> 本文发布于 [李牧牧的博客](http://limumu.me) 转载请保留链接 ;)

  

摘要：

> 随着公司业务的不断迅速增长，使得管理 IT 基础设施需求变得更为艰难。初创企业或小微互联网公司的程序员往往开发运维两兼职，那么如果简单有效的搭建整套自动化运维监控系统变的十分重要。



### 知己知彼，百战不殆

![](http://onb688cva.bkt.clouddn.com/assets:post:img:2017041801_devops.png)

我们窥探一只互联网小团队他们的运维系统功能清单

- [x] 配置网络设备和服务器
- [x] 新虚拟机的配置
- [x] 应用程序部署
- [x] 收集和聚合的日志
- [x] 性能监视服务、网络和应用程序
- [x] 服务器异常报警和服务可用性监控

想要完全部署以上功能，如果不使用正确的工具集来执行这些任务将会是一件即费时又费钱的事。某些工具需要巨大的投资，而有一些却很容易获取，因为它们是开源。你可以进行一个简单的成本效益分析, 然后选择一组工具，帮助你解决当前应用场景下遇到的问题。



### 小步快跑＋快速迭代

> 传统软件企业的软件产品从无到有流程相对繁琐，对于需要快速开发迭代的初创互联网企业来说，时间线拉得有点太长。

![](http://onb688cva.bkt.clouddn.com/assets:post:img:2017041705_aliyun.png)



> 往往一家互联网小团队会采用如下方式

![](http://onb688cva.bkt.clouddn.com/assets:post:img:2017041706_aliyun.png)



> 预备期

产品经理跟需求方沟通，了解要平台、功能、产品设计的需求、时长、预算等等，只有了解客户的详细需求才能做出开发方案，提交方案后需要找前端与后端开发、测试人员探讨方案可行性，包括功能开发的难度、实际开发的费用以及时间，接着项目各个组开始讨论，UI 设计针对产品开展设计 UI 界面跟 UE ，最后将所有文档上传共享到公司文档系统中。



> 孵化期

相关研发组长根据产品需求文档进行评估提出测评、预发跟正式发布时间，前后端研发根据业务松紧程度安排晨会、每周进度会议，直到项目顺利进入测试阶段，然后由测试专员针对 App 进行多机型内容测试、性能测试、功能测试、视觉测试并将问题提交到 Bug 系统让接口研发人员调试修复，确认没有BUG后开始走验收流程，很多大型互联网企业的验收流程会有（DEV、SIT、UAT、QAS、PRE、PRD），小团队通常会缩短为（DEV、SIT、QAS、PRD）。



> 新生期

上线需要申请成为公司开发者并上传真实有效各项材料，除了 App Store 外，国内多个安卓市场都需要单独申请与上传合法材料，一般苹果的 App Store 审核大概需要一个星期，安卓审核在 3 天左右，所以 App 开发测试一定要提前半个月完成，给长线审核预留一定的时间，如需要微信用户下载 App ，需要单独注册腾讯应用宝，到此 App 才算上线成功提供给用户下载使用。



### 开始搭建全链路服务

> 给计算机安装操作系统

给公司内部使用的服务器其实没有高低贵贱之分，合理利用服务器资源，小团队一般不会配备专业的全职运维，那么选择硬件服务器提供商时需要着重于售后服务，往往品牌服务器供应商的售后都有保障。创业团队刚开始不必考虑硬件服务器是购买刀片机还是塔式机，其实单台工作站电脑就完全可以满足公司内部日常工作，线上生产服务应该交给云服务提供商，如果公司除了移动应用业务线，还有公司内部管理系统业务线，笔者建议购买三台工作站分别处理移动端全线业务、企业内部系统业务、数据中心服务器，之所以独立出把于数据相关的服务独立出来也是为了结构清晰方便管理与监控。如果条件允许的话一定要给服务器配备 UPS 电源，不要太依赖硬盘。

*** 总结 *** 

- [x] 选择硬件服务器关键是售后要靠谱
- [x] 购买普通工组站电脑就够了（ 32G 内存 1T 硬盘无独显）
- [x] 数据中心与业务线各自独立使用物理服务器
- [x] 给服务器配备 UPS 应急电源

[如何给服务器安装操作系统？](http://www.limumu.me/2017/02/01/create-os-from-server/ "如何给服务器安装操作系统？")  - 来源 李牧牧博客


> 让应用容器化

实际工作中，往往需要在同一台物理计算机中安装多个应用服务，为了服务之间网络地址与端口不相互冲突，会在物理机安装多个虚拟操作系统才解决问题。

市面上虚拟化主流工具对比

- [x] KVM           对于研发人员上手难度相对较高，社区成熟资料齐全
- [x] Vmware     CPU与内存的占用相对较大，必须先安装操作系统再安装应用软件
- [x] VirtualBox CPU与内存的占用相对较大，作用于服务器有点浪费资源
- [x] Docker       应用容器引擎，可移植性好保障线上线下环境一致性，操作简单。


[如何部署分布式容器服务？](http://www.limumu.me/2017/02/01/create-docker-from-os/ "如何部署分布式容器服务？")  - 来源 李牧牧博客


> 日志 与 备份 兼得

当业务服务慢慢增多时，如何合理安排好日志文件与应用版本包备份存放位置变得尤为重要，如果日志业务量大小还不需要（ElasticSearch＋LogStash＋Kibana）采集、清洗、分析日志数据的话，如何简单有效的将多台物理机的各种环境日志统一管理备份起来。

[如何借助阿里云OSS备份全环境日志？](http://www.limumu.me/2017/02/02/create-logback-from-oss/ "如何借助阿里云OSS备份全环境日志？")  - 来源 李牧牧博客


> 代码的版本控制





> 私有的项目库



> 一句话生产中间件



> 有请发包总管



> 通知小秘书



> 协作知识文档



> 测试员的利器



> 无止尽的报表



> 把文档存下来





### 总结一下

### Q & A




















